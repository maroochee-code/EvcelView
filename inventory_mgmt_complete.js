// 재고 관리하기 시나리오 완성 버전
const inventoryMgmtScenarioComplete = {
    id: "inventory_mgmt",
    title: "재고 관리하기",
    description: "효율적인 재고 관리 시스템을 구축하여 입출고부터 적정재고까지 체계적으로 관리하는 방법을 학습합니다.",
    
    // 단계별 가이드
    steps: [
        {
            step: 1,
            title: "재고 현황 파악하기",
            description: "현재 재고량을 정확히 파악하고 재고 목록을 체계적으로 정리합니다.",
            functions: ["SUMIF", "COUNTIF", "VLOOKUP"],
            example: {
                data: [
                    ["A", "B", "C", "D"],
                    ["제품코드", "제품명", "현재고", "단위"],
                    ["P001", "노트북", "50", "대"],
                    ["P002", "마우스", "200", "개"],
                    ["P003", "키보드", "150", "개"],
                    ["P004", "모니터", "80", "대"]
                ],
                formula: "=SUMIF(D2:D5,\"대\",C2:C5)",
                result: "130",
                explanation: "단위가 '대'인 제품들의 총 재고량을 계산합니다."
            }
        },
        {
            step: 2,
            title: "입출고 관리하기",
            description: "입고와 출고를 체계적으로 관리하고 실시간 재고량을 계산합니다.",
            functions: ["SUM", "TODAY", "IF"],
            example: {
                data: [
                    ["A", "B", "C", "D", "E"],
                    ["날짜", "제품코드", "구분", "수량", "잔여재고"],
                    ["2025-05-20", "P001", "입고", "20", "=기존재고+D2"],
                    ["2025-05-21", "P001", "출고", "-5", "=이전재고+D3"],
                    ["2025-05-22", "P001", "출고", "-3", "=이전재고+D4"]
                ],
                formula: "=IF(C2=\"입고\",이전재고+D2,이전재고+D2)",
                result: "62대",
                explanation: "입고는 양수(+), 출고는 음수(-)로 처리하여 실시간 재고량을 계산합니다."
            }
        },
        {
            step: 3,
            title: "안전재고 및 발주점 계산",
            description: "적정 안전재고량과 발주시점을 계산하여 재고 부족을 방지합니다.",
            functions: ["AVERAGE", "MAX", "IF"],
            example: {
                data: [
                    ["A", "B", "C", "D", "E"],
                    ["제품명", "일평균사용량", "리드타임(일)", "안전재고", "발주점"],
                    ["노트북", "3", "7", "=B2*C2*1.5", "=B2*C2+D2"],
                    ["마우스", "15", "5", "=B3*C3*1.5", "=B3*C3+D3"],
                    ["키보드", "10", "5", "=B4*C4*1.5", "=B4*C4+D4"]
                ],
                formula: "=일평균사용량*리드타임*1.5",
                result: "안전재고: 32개",
                explanation: "안전재고 = 일평균사용량 × 리드타임 × 안전계수(1.5)"
            }
        },
        {
            step: 4,
            title: "재고 회전율 분석",
            description: "재고 회전율을 계산하여 재고 효율성을 평가합니다.",
            functions: ["ROUND", "AVERAGE"],
            example: {
                data: [
                    ["A", "B", "C", "D"],
                    ["제품명", "월평균재고", "월판매량", "재고회전율"],
                    ["노트북", "60", "20", "=ROUND(C2/B2,2)"],
                    ["마우스", "180", "90", "=ROUND(C3/B3,2)"],
                    ["키보드", "140", "70", "=ROUND(C4/B4,2)"]
                ],
                formula: "=ROUND(월판매량/월평균재고,2)",
                result: "0.33회",
                explanation: "재고회전율 = 월판매량 ÷ 월평균재고 (높을수록 효율적)"
            }
        },
        {
            step: 5,
            title: "자동 발주 알림 시스템",
            description: "현재 재고가 발주점 이하로 떨어지면 자동으로 알림을 표시합니다.",
            functions: ["IF", "COUNTIF"],
            example: {
                data: [
                    ["A", "B", "C", "D"],
                    ["제품명", "현재고", "발주점", "발주필요여부"],
                    ["노트북", "25", "53", "=IF(B2<=C2,\"긴급발주\",\"정상\")"],
                    ["마우스", "200", "113", "=IF(B3<=C3,\"긴급발주\",\"정상\")"],
                    ["키보드", "40", "88", "=IF(B4<=C4,\"긴급발주\",\"정상\")"]
                ],
                formula: "=IF(현재고<=발주점,\"긴급발주\",\"정상\")",
                result: "긴급발주",
                explanation: "현재 재고가 발주점 이하이면 '긴급발주' 알림을 표시합니다."
            }
        }
    ],
    
    // 관련 함수들
    relatedFunctions: [
        {
            name: "SUMIF",
            usage: "조건별 재고 합계",
            formula: "=SUMIF(카테고리범위,\"전자제품\",재고량범위)",
            description: "특정 카테고리별 총 재고량 계산"
        },
        {
            name: "COUNTIF",
            usage: "재고 부족 품목 개수",
            formula: "=COUNTIF(재고량범위,\"<\"&안전재고)",
            description: "안전재고 이하 품목 개수 파악"
        },
        {
            name: "VLOOKUP",
            usage: "제품 정보 조회",
            formula: "=VLOOKUP(제품코드,제품마스터,2,FALSE)",
            description: "제품코드로 제품명이나 단가 조회"
        },
        {
            name: "TODAY",
            usage: "입출고 날짜 자동 입력",
            formula: "=TODAY()",
            description: "오늘 날짜 자동 입력으로 입출고 일자 관리"
        },
        {
            name: "AVERAGE",
            usage: "평균 사용량 계산",
            formula: "=AVERAGE(월별사용량범위)",
            description: "과거 데이터 기반 평균 사용량 산출"
        },
        {
            name: "IF",
            usage: "재고 상태 판단",
            formula: "=IF(현재고<안전재고,\"부족\",\"충분\")",
            description: "재고 상태에 따른 자동 분류"
        },
        {
            name: "MAX/MIN",
            usage: "최대/최소 재고량 파악",
            formula: "=MAX(재고량범위)",
            description: "가장 많거나 적은 재고량 품목 찾기"
        },
        {
            name: "ROUND",
            usage: "재고 회전율 반올림",
            formula: "=ROUND(판매량/평균재고,2)",
            description: "소수점 둘째자리까지 반올림하여 가독성 향상"
        }
    ],
    
    // 실무 팁
    practicalTips: [
        {
            title: "ABC 분석 활용",
            tip: "매출 기여도에 따라 A급(80%), B급(15%), C급(5%)으로 분류하여 A급 제품은 더 자주 모니터링하세요."
        },
        {
            title: "계절성 고려",
            tip: "계절에 따라 수요가 변하는 제품은 과거 동기간 데이터를 참고하여 안전재고를 조정하세요."
        },
        {
            title: "공급업체별 리드타임 관리",
            tip: "공급업체별로 다른 리드타임을 별도 테이블로 관리하고 VLOOKUP으로 자동 조회하도록 설정하세요."
        },
        {
            title: "재고 비용 계산",
            tip: "재고 보관비용, 기회비용을 고려하여 적정 재고량을 산출하면 더 정확한 관리가 가능합니다."
        },
        {
            title: "정기 재고 실사",
            tip: "시스템 재고와 실제 재고의 차이를 주기적으로 확인하고 오차 원인을 분석하세요."
        }
    ],
    
    // 템플릿 예시
    templateExample: {
        headers: ["제품코드", "제품명", "현재고", "안전재고", "발주점", "공급업체", "단가", "최종입고일", "재고상태"],
        sampleData: [
            ["P001", "노트북", "25", "32", "53", "ABC전자", "800000", "2025-05-15", "=IF(C2<=D2,\"부족\",\"충분\")"],
            ["P002", "마우스", "200", "38", "113", "DEF컴퓨터", "30000", "2025-05-18", "=IF(C3<=D3,\"부족\",\"충분\")"],
            ["P003", "키보드", "40", "38", "88", "GHI전자", "80000", "2025-05-10", "=IF(C4<=D4,\"부족\",\"충분\")"]
        ]
    },
    
    // 고급 기능
    advancedFeatures: [
        {
            title: "자동 발주 수량 계산",
            description: "경제적 주문량(EOQ) 공식을 활용한 최적 발주량 계산",
            formula: "=SQRT(2*연간수요량*주문비용/보관비용)"
        },
        {
            title: "재고 가치 평가",
            description: "FIFO, LIFO, 가중평균법을 활용한 재고 가치 산정",
            formula: "=SUMPRODUCT(수량범위,단가범위)"
        },
        {
            title: "데이터 검증",
            description: "입력 오류 방지를 위한 데이터 유효성 검사 설정",
            tip: "제품코드는 드롭다운 목록으로, 수량은 양수만 입력 가능하도록 설정"
        }
    ]
};

// 전역으로 노출
if (typeof window !== 'undefined') {
    window.inventoryMgmtScenarioComplete = inventoryMgmtScenarioComplete;
}